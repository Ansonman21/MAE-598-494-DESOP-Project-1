# MAE-598-494-DESOP-Project-1

In this project, we formulated an optimization problem centered around the controlled descent of a rocket, with the dual objectives of ensuring a safe landing and minimizing fuel consumption. The problem is defined within a one-dimensional space, focusing on the vertical motion of the rocket. Key variables in this formulation include the rocket's vertical position and velocity, and the control variable is the mass flow rate of the propellant. The dynamics of the rocket are governed by Newton's laws, factoring in gravitational forces, the thrust generated, and the changing mass due to fuel consumption. Constraints are imposed to ensure physical realism, such as non-negative height and bounded mass flow rate, alongside velocity constraints to prevent crashing or overshooting. The problem is simplified by assuming instantaneous adjustability of thrust and neglecting external factors like air resistance. This formulation encapsulates the complexities of rocket descent dynamics while focusing on the critical aspects of landing safety and fuel efficiency.

### Dynamic Equations

The motion of the rocket is governed by the following equations:

1. **Vertical Position** (`y`):
   ![equation](https://latex.codecogs.com/png.latex?y_%7Bnew%7D%20%3D%20y%20&plus;%20v_y%20%5Ccdot%20%5CDelta%20t%20&plus;%20%5Cfrac%7B1%7D%7B2%7D%20a_r%20%5Ccdot%20%5CDelta%20t%5E2)

2. **Vertical Velocity** (`v_y`):
   ![equation](https://latex.codecogs.com/png.latex?v_%7By_%7Bnew%7D%7D%20%3D%20v_y%20&plus;%20a_r%20%5Ccdot%20%5CDelta%20t)

3. **Acceleration** (`a_r`):
   ![equation](https://latex.codecogs.com/png.latex?a_r%20%3D%20%5Cfrac%7Bm_%7B%5Cdot%7Bp%7D%7D%20%5Ccdot%20V_e%20&plus;%20%28p_e%20-%20p_%7B%5Cinfty%7D%29%20%5Ccdot%20A_e%20-%20%28m_0%20-%20m_%7B%5Cdot%7Bp%7D%7D%20%5Ccdot%20%5CDelta%20t%29%20%5Ccdot%20g%7D%7Bm_0%20-%20m_%7B%5Cdot%7Bp%7D%7D%20%5Ccdot%20%5CDelta%20t%7D)

   Where:
   - `m_dot_p` is the mass flow rate of the propellant.
   - `V_e` is the exit velocity at the nozzle.
   - `p_e` and `p_inf` are the exit and ambient pressures, respectively.
   - `A_e` is the exit area of the nozzle.
   - `m_0` is the initial mass of the rocket.
   - `g` is the acceleration due to gravity.
   - `delta_t` is the time step.

### Constraints

1. **Non-negative Height**:
   ![equation](https://latex.codecogs.com/png.latex?y%20%5Cgeq%200)

2. **Bounded Mass Flow Rate**:
   ![equation](https://latex.codecogs.com/png.latex?0%20%5Cleq%20m_%7B%5Cdot%7Bp%7D%7D%20%5Cleq%20m_%7B%5Cdot%7Bp%7D_%7Bmax%7D%7D)

3. **Velocity Constraints**:
   - To prevent crashing: ![equation](https://latex.codecogs.com/png.latex?v_y%20%5Cgeq%20v_%7By_%7Bmin%7D%7D)
   - To prevent overshooting: ![equation](https://latex.codecogs.com/png.latex?v_y%20%5Cleq%20v_%7By_%7Bmax%7D%7D)

### Assumptions

1. The motion of the rocket is restricted to vertical movement only.
2. The thrust can be adjusted instantaneously.
3. External factors like air resistance are neglected.
4. The gravitational force is considered constant.
5. The rocket's structure is rigid, and its shape does not change during descent.

These equations, constraints, and assumptions form the basis of the problem formulation, capturing the essential physics of the rocket's descent while simplifying the model to focus on the primary objectives of safe landing and fuel efficiency.

### 1. Documentation of the Problem Formulation

  Objective Function:
      
  The primary objective is to optimize the control of a rocket's descent to ensure a safe landing while minimizing the amount of fuel burned during descent. This involves minimizing the final height and velocity of the rocket at the end of the descent, aiming for a soft landing at a target location (height = 0).
  
  Variables:
      
  State Variables: Position (y) and velocity (vy) of the rocket.
  Control Variable: Mass flow rate of propellant (m_dot_p).
  
  Constraints:
      
  Dynamical System: The rocket's motion is governed by Newton's laws of motion, considering gravitational force, thrust generated by the rocket, and the changing mass of the rocket as fuel is consumed.
  Physical Constraints: Non-negative height, non-negative and bounded mass flow rate, and constraints on the velocity to avoid crashing or overshooting.
  
  Assumptions:
      
  The rocket's motion is considered in a one-dimensional space (vertical motion only).
  Air resistance and other environmental factors are neglected.
  The rocket's thrust is assumed to be adjustable instantaneously according to the control variable.

### 2. Programming

  Please see attached python script.

### 3. Analysis of the Results

  Issues Encountered:
      
  Incorrect Problem Formulations: Initially, the model did not account for the changing mass of the rocket due to fuel consumption, leading to unrealistic behavior. This was corrected by incorporating the mass flow rate into the dynamics.
  Hyperparameter Tuning: Finding the right balance for the learning rate and the number of epochs in the optimization algorithm was challenging. Too high a learning rate caused instability, while too low a rate resulted in slow convergence.
  Coding Issues: Ensuring that tensor operations in PyTorch were performed correctly, especially avoiding in-place operations that could interfere with gradient calculations, was crucial. Debugging these issues required careful examination of tensor shapes and operations.
  
  Lessons Learned:
      
  The importance of accurately modeling the physical system and understanding its constraints.
  The sensitivity of optimization algorithms to hyperparameters, necessitating careful tuning.
  The need for rigorous testing and validation of each component of the model to ensure realistic behavior.

### 4. Visualization

  Final Results Visualization:
      
  A GIF animation was created to visually represent the rocket's descent and landing. This animation shows the rocket's height, velocity, and thrust over time, providing an intuitive understanding of the descent dynamics.
  Additional plots were generated to illustrate the trajectory of the rocket in terms of height, velocity, acceleration, fuel consumption, and mass flow rate over time. These plots offer a detailed view of the rocket's behavior during descent and the effectiveness of the control strategy.
  The visualization effectively communicates the outcome of the optimization, demonstrating a successful controlled descent and landing.
  
  Effectiveness:
      
  The combination of animation and plots provides a comprehensive and understandable overview of the project's results.
  The visualization aids in conveying complex dynamical behavior in an accessible manner, making it easier for others to grasp the achievements of the project.
